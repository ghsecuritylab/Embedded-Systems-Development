/*
 * PanasonicAC_Wired.c
 *
 *  Created on: 26.09.2017
 *      Author: lzhang
 */


#include "PanasonicAC_Wired.h"

uint8_t click_count;
extern currentState;

void PanasonicAC_Wired_Init(){

	//	Set MODE from FAN to AUTO
	click_count = 3;
	while (click_count > 0){
		EXPAND4click_set(4);
		delayUS(500000);
		EXPAND4click_set(0);
		delayUS(500000);
		click_count--;
	}

	//	Set TEMP from 25°C to 20°C
	click_count = 5;
	while (click_count > 0){
	   EXPAND4click_set(2); //DOWN
	   delayUS(500000);
	   EXPAND4click_set(0);
	   delayUS(500000);
	   click_count--;
	}
}


void PanasonicAC_Wired_PowerOn(void){
	EXPAND4click_set(8); //ON OFF
	delayUS(500000);
}

void PanasonicAC_Wired_SetMode(){
    EXPAND4click_set(4); //MODE
    delayUS(500000);
    EXPAND4click_set(0);
    delayUS(500000);
}

void PanasonicAC_Wired_SetTemp(){
	// TEMP DOWN
	if (pTC_IstTemperature > TC_SollTemperature){
		click_count = pTC_IstTemperature - TC_SollTemperature;
		while (click_count > 0){
			EXPAND4click_set(2); //DOWN
			delayUS(500000);
			EXPAND4click_set(0);
			delayUS(500000);
			click_count--;
		}
	}

	// TEMP UP
	if (pTC_IstTemperature < TC_SollTemperature){
		click_count = TC_SollTemperature - pTC_IstTemperature;
		while (click_count > 0){
			EXPAND4click_set(1); //UP
			delayUS(500000);
			EXPAND4click_set(0);
			delayUS(500000);
			click_count--;
		}
	}
}

void PanasonicAC_Wired_SetFanSpeed(){
	// Set FAN speed from AUTO to LO
	if (currentState == Standby){
		EXPAND4click_set(32);
		delayUS(500000);
		EXPAND4click_set(0);
		delayUS(500000);
	}
}
